---
title: "DSA2101 Group Project"
output: github_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
library(tidytuesdayR)
library(tidyverse)
library(readr)
```

# Analysis of Taylor Swift Spotify Data

Name                 | Matriculation number
Chua Yong Sheng Joel | A_
Lim Zeen Kiat        | A_
Robin Ghosh          | A0271671A
Timothy Teo Shao Jun | A0272851B

=======

## Introduction

(To start on)


## Loading Data
```{r}
# Load the Tidy Tuesday datasets for Taylor Swift from Week 42 of 2023
tuesdata <- tidytuesdayR::tt_load(2023, week = 42)

# Extract specific datasets
taylor_album_songs <- tuesdata$taylor_album_songs
taylor_all_songs <- tuesdata$taylor_all_songs
taylor_albums <- tuesdata$taylor_albums

# Save each dataset to CSV files
# write.csv(taylor_album_songs, "taylor_album_songs.csv", row.names = FALSE)
# write.csv(taylor_all_songs, "taylor_all_songs.csv", row.names = FALSE)
# write.csv(taylor_albums, "taylor_albums.csv", row.names = FALSE)
# >>>>>> e3542bd358543883b147a6664c5777a5ed2ce66e
```


## Description of our Data
```{r}
summary(taylor_album_songs)
summary(taylor_all_songs)
summary(taylor_albums)
```

A brief description of the variables relevant to our project is given below:
(To start on)


## Data Cleaning

Start off by filtering for the columns that we want:
```{r}
taylor_album_songs <- taylor_album_songs %>%
    select(album_name, album_release, track_name, loudness, mode, speechiness, acousticness, instrumentalness, valence, tempo, explicit)

taylor_all_songs <- taylor_all_songs %>%
    select(album_name, album_release, track_name, loudness, mode, speechiness, acousticness, instrumentalness, valence, tempo, explicit)

taylor_albums <- taylor_albums %>%
    select(!ep)
```

Group by albums:
```{r}
taylor_album_songs <- taylor_album_songs %>%
  group_by(album_name)

taylor_all_songs <- taylor_all_songs %>%
  group_by(album_name)

taylor_albums <- taylor_albums %>%
  group_by(album_name)
```

Checking for NA values in each file:
```{r}
taylor_album_songs_na_count <- sapply(taylor_album_songs, function(x) sum(is.na(x)))
print(taylor_album_songs_na_count)

taylor_all_songs_na_count <- sapply(taylor_all_songs, function(x) sum(is.na(x)))
print(taylor_all_songs_na_count)

taylor_albums_na_count <- sapply(taylor_albums, function(x) sum(is.na(x)))
print(taylor_albums_na_count)
```

There are many occurences of NA data present. Hence, we will need to remove them:
```{r}
taylor_album_songs <- taylor_album_songs %>%
    na.omit()

taylor_all_songs <- taylor_all_songs %>%
    na.omit()

taylor_albums <- taylor_albums %>%
    na.omit()
```

Save cleaned data as new files:
```{r}
write.csv(taylor_album_songs, "CSV files/taylor_album_songs_cleaned.csv", row.names = FALSE)
write.csv(taylor_all_songs, "CSV files/taylor_all_songs_cleaned.csv", row.names = FALSE)
write.csv(taylor_albums, "CSV files/taylor_albums.csv_cleaned", row.names = FALSE)
```


```{r using-cleaned-datasets}
head(taylor_album_songs)
head(taylor_all_songs)
head(taylor_albums)
```

```{r}
names(taylor_album_songs)==names(taylor_all_songs)
checking_conflicts <- taylor_album_songs %>% anti_join(taylor_all_songs, by=names(taylor_all_songs))
head(checking_conflicts)
```

All the column names match for both tables. A tibble of no elements was generated, thus confirming that all rows are present in either tables. Since we can choose which
table we want, we will use taylor_album_songs.

Next, since we are trying to compare popularity statistics by album, we need to check which albums are present in `r taylor_album_songs` and `r taylor_albums`.



```{r}
names1 <- taylor_albums %>% select(album_name) %>% unique() %>% arrange(album_name)
names2 <- taylor_album_songs %>% select(album_name) %>% unique() %>% arrange(album_name)

comp_table=left_join(names1, names2, by=c("album_name"))

combined_table = rep(NA,length(comp_table$album_name))

for (i in 1:length(names1$album_name) ){
  if (names1$album_name[i] %in% names2$album_name) {
    combined_table[i] <- comp_table$album_name[i]
  }
}

combined_table = cbind(names1$album_name,combined_table)
knitr::kable(combined_table, col.names = c("Taylor Albums","Taylor Album Songs"), caption="Comparison of album names between the tables")
```
